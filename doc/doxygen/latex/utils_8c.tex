\hypertarget{utils_8c}{\section{utils.\-c File Reference}
\label{utils_8c}\index{utils.\-c@{utils.\-c}}
}


This file implements various utility functions that are can be used by the storage server and client library.  


{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$sys/types.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include \char`\"{}utils.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}parser.\-tab.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{utils_8c_acd8617a8f2ac0de8bc1cc032cf449e19}{int {\bfseries yyparse} ()}\label{utils_8c_acd8617a8f2ac0de8bc1cc032cf449e19}

\item 
int \hyperlink{utils_8c_a73c4a410d877b6a9358c547786f2102c}{sendall} (const int sock, const char $\ast$buf, const size\-\_\-t len)
\begin{DoxyCompactList}\small\item\em Keep sending the contents of the buffer until complete. \end{DoxyCompactList}\item 
int \hyperlink{utils_8c_ab126c8228ad72abbaed5f282709446ab}{recvline} (const int sock, char $\ast$buf, const size\-\_\-t buflen)
\begin{DoxyCompactList}\small\item\em Receive an entire line from a socket. \end{DoxyCompactList}\item 
int \hyperlink{utils_8c_ae885a5871d260ab51ce6a9156f41f07e}{read\-\_\-config} (const char $\ast$config\-\_\-file, struct \hyperlink{structconfig__params}{config\-\_\-params} $\ast$params)
\begin{DoxyCompactList}\small\item\em Read and load configuration parameters. \end{DoxyCompactList}\item 
void \hyperlink{utils_8c_a46941812eb2be73d5c79ea0596ed81fc}{logger} (F\-I\-L\-E $\ast$file, char $\ast$message, int logging\-Constant)
\begin{DoxyCompactList}\small\item\em Generates a log message. \end{DoxyCompactList}\item 
char $\ast$ \hyperlink{utils_8c_aa26d27a9072e93c052cb0c7fca7909f7}{generate\-\_\-encrypted\-\_\-password} (const char $\ast$passwd, const char $\ast$salt)
\begin{DoxyCompactList}\small\item\em Generates an encrypted password string using salt C\-R\-Y\-P\-T\-\_\-\-S\-A\-L\-T. \end{DoxyCompactList}\item 
void \hyperlink{utils_8c_a92f2177b1564f1d2dc88a185c19639da}{get\-\_\-param} (char str\mbox{[}\hyperlink{storage_8h_a00a29850f2b5b985f776f864d83e5ac3}{M\-A\-X\-\_\-\-V\-A\-L\-U\-E\-\_\-\-L\-E\-N}\mbox{]}, char to\-\_\-return\mbox{[}\hyperlink{storage_8h_a00a29850f2b5b985f776f864d83e5ac3}{M\-A\-X\-\_\-\-V\-A\-L\-U\-E\-\_\-\-L\-E\-N}\mbox{]}, int param\-\_\-num, char $\ast$delims)
\begin{DoxyCompactList}\small\item\em Split a string and return one of the split strings. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{utils_8c_a46af646807e0797e72b6e8945e7ea88b}{F\-I\-L\-E $\ast$ {\bfseries yyin}}\label{utils_8c_a46af646807e0797e72b6e8945e7ea88b}

\item 
\hypertarget{utils_8c_ac72bec1a67c7044a962c10f0a2f41697}{int {\bfseries error\-\_\-occurred} = 0}\label{utils_8c_ac72bec1a67c7044a962c10f0a2f41697}

\item 
\hypertarget{utils_8c_a65c4b11f80c62d337cd43ebc6eb0405f}{int {\bfseries server\-\_\-hostcount} = 0}\label{utils_8c_a65c4b11f80c62d337cd43ebc6eb0405f}

\item 
\hypertarget{utils_8c_a71e103c47a57c1f3ffa981009b156c17}{int {\bfseries server\-\_\-portcount} = 0}\label{utils_8c_a71e103c47a57c1f3ffa981009b156c17}

\item 
\hypertarget{utils_8c_ab7fac103e4652083b1a5ebbae44387b7}{int {\bfseries usernamecount} = 0}\label{utils_8c_ab7fac103e4652083b1a5ebbae44387b7}

\item 
\hypertarget{utils_8c_afc8ca7c4338993fbfc280631f076674d}{int {\bfseries passwordcount} = 0}\label{utils_8c_afc8ca7c4338993fbfc280631f076674d}

\item 
\hypertarget{utils_8c_a0d5203b200722f916fca5996653ccdc2}{int {\bfseries tablecount} = 0}\label{utils_8c_a0d5203b200722f916fca5996653ccdc2}

\item 
\hypertarget{utils_8c_a7634e11c370b4ed3cf01ac88666786ec}{int {\bfseries storagepolicycount} = 0}\label{utils_8c_a7634e11c370b4ed3cf01ac88666786ec}

\item 
\hypertarget{utils_8c_aef1aaac904ac2373be409aa8a7383352}{int {\bfseries datadirectorycount} = 0}\label{utils_8c_aef1aaac904ac2373be409aa8a7383352}

\item 
\hypertarget{utils_8c_a75b19006e249833a1b6d0d34278c9737}{struct \hyperlink{structconfig__params}{config\-\_\-params} {\bfseries paramslex}}\label{utils_8c_a75b19006e249833a1b6d0d34278c9737}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file implements various utility functions that are can be used by the storage server and client library. 

Definition in file \hyperlink{utils_8c_source}{utils.\-c}.



\subsection{Function Documentation}
\hypertarget{utils_8c_aa26d27a9072e93c052cb0c7fca7909f7}{\index{utils.\-c@{utils.\-c}!generate\-\_\-encrypted\-\_\-password@{generate\-\_\-encrypted\-\_\-password}}
\index{generate\-\_\-encrypted\-\_\-password@{generate\-\_\-encrypted\-\_\-password}!utils.c@{utils.\-c}}
\subsubsection[{generate\-\_\-encrypted\-\_\-password}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ generate\-\_\-encrypted\-\_\-password (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{passwd, }
\item[{const char $\ast$}]{salt}
\end{DoxyParamCaption}
)}}\label{utils_8c_aa26d27a9072e93c052cb0c7fca7909f7}


Generates an encrypted password string using salt C\-R\-Y\-P\-T\-\_\-\-S\-A\-L\-T. 


\begin{DoxyParams}{Parameters}
{\em passwd} & Password before encryption. \\
\hline
{\em salt} & Salt used to encrypt the password. If N\-U\-L\-L default value D\-E\-F\-A\-U\-L\-T\-\_\-\-C\-R\-Y\-P\-T\-\_\-\-S\-A\-L\-T is used. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns encrypted password. 
\end{DoxyReturn}


Definition at line 151 of file utils.\-c.



References D\-E\-F\-A\-U\-L\-T\-\_\-\-C\-R\-Y\-P\-T\-\_\-\-S\-A\-L\-T.



Referenced by storage\-\_\-auth().

\hypertarget{utils_8c_a92f2177b1564f1d2dc88a185c19639da}{\index{utils.\-c@{utils.\-c}!get\-\_\-param@{get\-\_\-param}}
\index{get\-\_\-param@{get\-\_\-param}!utils.c@{utils.\-c}}
\subsubsection[{get\-\_\-param}]{\setlength{\rightskip}{0pt plus 5cm}void get\-\_\-param (
\begin{DoxyParamCaption}
\item[{char}]{str\mbox{[}\-M\-A\-X\-\_\-\-V\-A\-L\-U\-E\-\_\-\-L\-E\-N\mbox{]}, }
\item[{char}]{to\-\_\-return\mbox{[}\-M\-A\-X\-\_\-\-V\-A\-L\-U\-E\-\_\-\-L\-E\-N\mbox{]}, }
\item[{int}]{param\-\_\-num, }
\item[{char $\ast$}]{delims}
\end{DoxyParamCaption}
)}}\label{utils_8c_a92f2177b1564f1d2dc88a185c19639da}


Split a string and return one of the split strings. 


\begin{DoxyParams}{Parameters}
{\em str} & string to be split \\
\hline
{\em to\-\_\-return} & place to return the specified paramter in str \\
\hline
{\em param\-\_\-num} & which index of the split str to return \\
\hline
{\em delims} & string of all characters used to deliminate string \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
no return value 
\end{DoxyReturn}


Definition at line 168 of file utils.\-c.



Referenced by check\-\_\-column\-\_\-types(), check\-\_\-mycolumns(), check\-\_\-mycolumns\-\_\-pred(), check\-\_\-predicates(), handle\-\_\-command(), num\-\_\-col\-\_\-val(), num\-\_\-of\-\_\-predicates(), predicate\-\_\-true(), predicates\-\_\-true(), split\-\_\-query\-\_\-get\-\_\-column(), split\-\_\-query\-\_\-get\-\_\-value(), and storage\-\_\-get().

\hypertarget{utils_8c_a46941812eb2be73d5c79ea0596ed81fc}{\index{utils.\-c@{utils.\-c}!logger@{logger}}
\index{logger@{logger}!utils.c@{utils.\-c}}
\subsubsection[{logger}]{\setlength{\rightskip}{0pt plus 5cm}void logger (
\begin{DoxyParamCaption}
\item[{F\-I\-L\-E $\ast$}]{file, }
\item[{char $\ast$}]{message, }
\item[{int}]{L\-O\-G\-G\-I\-N\-G}
\end{DoxyParamCaption}
)}}\label{utils_8c_a46941812eb2be73d5c79ea0596ed81fc}


Generates a log message. 


\begin{DoxyParams}{Parameters}
{\em file} & The output stream \\
\hline
{\em message} & Message to log. \\
\hline
\end{DoxyParams}


Definition at line 131 of file utils.\-c.



Referenced by main(), storage\-\_\-auth(), storage\-\_\-connect(), storage\-\_\-get(), and storage\-\_\-set().

\hypertarget{utils_8c_ae885a5871d260ab51ce6a9156f41f07e}{\index{utils.\-c@{utils.\-c}!read\-\_\-config@{read\-\_\-config}}
\index{read\-\_\-config@{read\-\_\-config}!utils.c@{utils.\-c}}
\subsubsection[{read\-\_\-config}]{\setlength{\rightskip}{0pt plus 5cm}int read\-\_\-config (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{config\-\_\-file, }
\item[{struct {\bf config\-\_\-params} $\ast$}]{params}
\end{DoxyParamCaption}
)}}\label{utils_8c_ae885a5871d260ab51ce6a9156f41f07e}


Read and load configuration parameters. 


\begin{DoxyParams}{Parameters}
{\em config\-\_\-file} & The name of the configuration file. \\
\hline
{\em params} & The structure where config parameters are loaded. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Return 0 on success, -\/1 otherwise. 
\end{DoxyReturn}


Definition at line 81 of file utils.\-c.



References M\-A\-X\-\_\-\-C\-O\-L\-U\-M\-N\-S\-\_\-\-P\-E\-R\-\_\-\-T\-A\-B\-L\-E, config\-\_\-params\-::password, config\-\_\-params\-::server\-\_\-host, config\-\_\-params\-::server\-\_\-port, and config\-\_\-params\-::username.



Referenced by main().

\hypertarget{utils_8c_ab126c8228ad72abbaed5f282709446ab}{\index{utils.\-c@{utils.\-c}!recvline@{recvline}}
\index{recvline@{recvline}!utils.c@{utils.\-c}}
\subsubsection[{recvline}]{\setlength{\rightskip}{0pt plus 5cm}int recvline (
\begin{DoxyParamCaption}
\item[{const int}]{sock, }
\item[{char $\ast$}]{buf, }
\item[{const size\-\_\-t}]{buflen}
\end{DoxyParamCaption}
)}}\label{utils_8c_ab126c8228ad72abbaed5f282709446ab}


Receive an entire line from a socket. 

In order to avoid reading more than a line from the stream, this function only reads one byte at a time. This is very inefficient, and you are free to optimize it or implement your own function. 

Definition at line 52 of file utils.\-c.



Referenced by main(), query\-\_\-command(), storage\-\_\-auth(), storage\-\_\-get(), and storage\-\_\-set().

\hypertarget{utils_8c_a73c4a410d877b6a9358c547786f2102c}{\index{utils.\-c@{utils.\-c}!sendall@{sendall}}
\index{sendall@{sendall}!utils.c@{utils.\-c}}
\subsubsection[{sendall}]{\setlength{\rightskip}{0pt plus 5cm}int sendall (
\begin{DoxyParamCaption}
\item[{const int}]{sock, }
\item[{const char $\ast$}]{buf, }
\item[{const size\-\_\-t}]{len}
\end{DoxyParamCaption}
)}}\label{utils_8c_a73c4a410d877b6a9358c547786f2102c}


Keep sending the contents of the buffer until complete. 

\begin{DoxyReturn}{Returns}
Return 0 on success, -\/1 otherwise.
\end{DoxyReturn}
The parameters mimic the send() function. 

Definition at line 32 of file utils.\-c.



Referenced by handle\-\_\-command(), query\-\_\-command(), storage\-\_\-auth(), storage\-\_\-get(), and storage\-\_\-set().

